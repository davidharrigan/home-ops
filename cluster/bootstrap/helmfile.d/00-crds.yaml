---
# yaml-language-server: $schema=https://json.schemastore.org/helmfile

# This helmfile extracts and installs only CRDs from Helm charts.
# Run with: helmfile -f 00-crds.yaml template | yq ea 'select(.kind == "CustomResourceDefinition")' | kubectl apply --server-side -f -

helmDefaults:
  args:
    - --include-crds
    - --no-hooks

repositories:
  - name: backube
    url: https://backube.github.io/helm-charts/
  - name: piraeus
    url: https://piraeus.io/helm-charts/
  - name: external-secrets
    url: https://charts.external-secrets.io

releases:
  - name: kube-prometheus-stack
    namespace: monitoring
    chart: oci://ghcr.io/prometheus-community/charts/kube-prometheus-stack
    version: 80.8.0
  - name: snapshot-controller
    namespace: kube-system
    chart: piraeus/snapshot-controller
    version: 4.2.0
  - name: volsync
    namespace: volsync-system
    chart: backube/volsync
    version: 0.14.0
  - name: external-secrets-crds
    namespace: external-secrets
    chart: external-secrets/external-secrets
    version: 1.2.1
